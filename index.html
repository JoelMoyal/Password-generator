<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Secure Password Generator</title>
    <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-2353052637618024"
     crossorigin="anonymous"></script>
    <style>
        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
        }

        html, body {
            height: 100%;
            width: 100%;
            font-family: 'Courier New', Courier, monospace;
            background-color: #0d0d0d;
            color: #00ff41;
        }

        /* CRT scanline overlay */
        body::before {
            content: '';
            position: fixed;
            top: 0; left: 0;
            width: 100%; height: 100%;
            background: repeating-linear-gradient(
                0deg,
                rgba(0, 0, 0, 0.08) 0px,
                rgba(0, 0, 0, 0.08) 1px,
                transparent 1px,
                transparent 2px
            );
            pointer-events: none;
            z-index: 9999;
        }

        .wrapper {
            display: flex;
            justify-content: center;
            align-items: flex-start;
            min-height: 100vh;
            padding: 30px 20px;
        }

        .container {
            width: 100%;
            max-width: 560px;
            background-color: #0d0d0d;
            border: 1px solid #00ff41;
            border-radius: 4px;
            padding: 28px 24px;
            box-shadow: 0 0 20px rgba(0, 255, 65, 0.2), 0 0 60px rgba(0, 255, 65, 0.05);
        }

        h1 {
            color: #00ff41;
            text-align: center;
            margin-bottom: 6px;
            font-size: clamp(1.2rem, 4vw, 1.6rem);
            letter-spacing: 2px;
            text-transform: uppercase;
            text-shadow: 0 0 10px rgba(0, 255, 65, 0.8);
        }

        .cursor {
            display: inline-block;
            animation: blink 1s step-end infinite;
            color: #00ff41;
        }

        @keyframes blink {
            0%, 100% { opacity: 1; }
            50% { opacity: 0; }
        }

        .subtitle {
            text-align: center;
            font-size: 11px;
            color: #00aa2b;
            letter-spacing: 3px;
            margin-bottom: 24px;
        }

        /* Section dividers */
        .section-label {
            font-size: 11px;
            letter-spacing: 3px;
            color: #00aa2b;
            margin: 20px 0 12px;
            display: flex;
            align-items: center;
            gap: 8px;
        }
        .section-label::before,
        .section-label::after {
            content: '';
            flex: 1;
            height: 1px;
            background: #003a0f;
        }

        .form-group {
            margin-bottom: 14px;
        }

        label {
            display: block;
            margin-bottom: 6px;
            font-size: 13px;
            color: #00cc33;
            letter-spacing: 1px;
        }

        input[type="number"],
        input[type="text"],
        textarea {
            width: 100%;
            padding: 10px 12px;
            border: 1px solid #00ff41;
            border-radius: 2px;
            font-size: 14px;
            font-family: 'Courier New', Courier, monospace;
            background-color: #010f04;
            color: #00ff41;
            outline: none;
            transition: box-shadow 0.2s;
        }

        input[type="number"]:focus,
        input[type="text"]:focus,
        textarea:focus {
            box-shadow: 0 0 10px rgba(0, 255, 65, 0.4);
        }

        textarea {
            resize: vertical;
            min-height: 70px;
        }

        .checkbox-group {
            margin-top: 5px;
        }

        .checkbox-item {
            display: flex;
            align-items: center;
            margin-bottom: 8px;
        }

        input[type="checkbox"] {
            margin-right: 10px;
            width: 16px;
            height: 16px;
            accent-color: #00ff41;
            cursor: pointer;
        }

        .checkbox-item label {
            margin-bottom: 0;
            font-size: 13px;
            font-weight: normal;
            cursor: pointer;
        }

        button {
            background-color: transparent;
            color: #00ff41;
            border: 1px solid #00ff41;
            padding: 12px 20px;
            border-radius: 2px;
            cursor: pointer;
            font-size: 14px;
            font-family: 'Courier New', Courier, monospace;
            letter-spacing: 2px;
            text-transform: uppercase;
            display: block;
            width: 100%;
            margin-top: 16px;
            transition: background-color 0.2s, box-shadow 0.2s, color 0.2s;
        }

        button:hover {
            background-color: #00ff41;
            color: #0d0d0d;
            box-shadow: 0 0 18px rgba(0, 255, 65, 0.6);
        }

        button:active {
            background-color: #00cc33;
        }

        /* AI button distinct color */
        .ai-btn {
            border-color: #00cfff;
            color: #00cfff;
        }

        .ai-btn:hover {
            background-color: #00cfff;
            color: #0d0d0d;
            box-shadow: 0 0 18px rgba(0, 207, 255, 0.6);
        }

        /* Password display */
        .password-container {
            margin-top: 16px;
            position: relative;
        }

        .password-display {
            padding: 14px;
            background-color: #010f04;
            border: 1px solid #00ff41;
            border-radius: 2px;
            font-family: 'Courier New', Courier, monospace;
            font-size: 15px;
            word-break: break-all;
            padding-right: 70px;
            min-height: 50px;
            color: #00ff41;
            text-shadow: 0 0 6px rgba(0, 255, 65, 0.6);
        }

        .password-display::before {
            content: '> ';
            opacity: 0.5;
        }

        .copy-btn {
            position: absolute;
            right: 8px;
            top: 50%;
            transform: translateY(-50%);
            background-color: transparent;
            color: #00ff41;
            border: 1px solid #00ff41;
            padding: 5px 10px;
            border-radius: 2px;
            cursor: pointer;
            font-size: 11px;
            font-family: 'Courier New', Courier, monospace;
            width: auto;
            margin: 0;
            letter-spacing: 1px;
        }

        .copy-btn:hover {
            background-color: #00ff41;
            color: #0d0d0d;
            box-shadow: 0 0 10px rgba(0, 255, 65, 0.5);
        }

        /* Strength meter */
        .strength-meter {
            height: 4px;
            margin-top: 10px;
            border-radius: 2px;
            background-color: #001a05;
            overflow: hidden;
        }

        .strength-fill {
            height: 100%;
            width: 0%;
            transition: width 0.4s, background-color 0.4s;
            box-shadow: 0 0 8px currentColor;
        }

        .strength-text {
            font-size: 11px;
            text-align: right;
            margin-top: 4px;
            letter-spacing: 2px;
        }

        /* AI result */
        .ai-result {
            margin-top: 14px;
            padding: 14px;
            background-color: #010f15;
            border: 1px solid #00cfff;
            border-radius: 2px;
            font-size: 13px;
            color: #00cfff;
            display: none;
            white-space: pre-wrap;
            word-break: break-word;
        }

        .ai-result.visible {
            display: block;
        }

        .ai-password-line {
            font-size: 15px;
            color: #00ff41;
            font-weight: bold;
            margin-bottom: 8px;
            text-shadow: 0 0 6px rgba(0, 255, 65, 0.6);
        }

        .ai-explanation {
            font-size: 12px;
            color: #0099cc;
            line-height: 1.5;
        }

        .ai-loading {
            color: #00cfff;
            font-size: 13px;
            letter-spacing: 2px;
            margin-top: 10px;
            display: none;
        }

        .ai-loading.visible {
            display: block;
            animation: pulse 1s ease-in-out infinite;
        }

        @keyframes pulse {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.3; }
        }

        /* Language toggle */
        .language-toggle {
            display: flex;
            justify-content: flex-end;
            margin-bottom: 20px;
        }

        .language-icons {
            display: flex;
            align-items: center;
            gap: 6px;
        }

        .lang-icon {
            width: 36px;
            height: 28px;
            cursor: pointer;
            opacity: 0.4;
            transition: all 0.2s;
            border-radius: 2px;
            display: flex;
            align-items: center;
            justify-content: center;
            background-color: transparent;
            color: #00ff41;
            font-weight: bold;
            font-size: 12px;
            border: 1px solid #003a0f;
            letter-spacing: 1px;
        }

        .lang-icon.active {
            opacity: 1;
            border-color: #00ff41;
            box-shadow: 0 0 8px rgba(0, 255, 65, 0.4);
        }

        .lang-icon:hover {
            opacity: 0.8;
        }

        /* Footer */
        .footer {
            margin-top: 28px;
            text-align: center;
            padding: 14px 0 0;
            border-top: 1px solid #003a0f;
            font-size: 12px;
            color: #00aa2b;
        }

        .footer-name {
            font-weight: 600;
            margin-bottom: 8px;
            letter-spacing: 2px;
        }

        .social-links {
            display: flex;
            justify-content: center;
            gap: 16px;
            margin-top: 10px;
        }

        .social-link {
            color: #00aa2b;
            text-decoration: none;
            transition: color 0.2s, text-shadow 0.2s;
            display: flex;
            align-items: center;
            font-size: 12px;
            letter-spacing: 1px;
        }

        .social-link:hover {
            color: #00ff41;
            text-shadow: 0 0 8px rgba(0, 255, 65, 0.6);
        }

        .social-icon {
            width: 16px;
            height: 16px;
            margin-right: 5px;
        }

        /* Mobile */
        @media (max-width: 480px) {
            .wrapper { padding: 10px; }
            .container { padding: 16px; }
            h1 { font-size: 1.1rem; }
        }

        @media (pointer: coarse) {
            input[type="checkbox"] { width: 20px; height: 20px; }
            button, .copy-btn, .checkbox-item { min-height: 44px; }
        }
    </style>
</head>
<body>
    <div class="wrapper">
        <div class="container">
            <div class="language-toggle">
                <div class="language-icons">
                    <div class="lang-icon active" id="lang-en">EN</div>
                    <div class="lang-icon" id="lang-de">DE</div>
                </div>
            </div>

            <h1 id="title">Secure Password Generator<span class="cursor">_</span></h1>
            <div class="subtitle" id="subtitle">[ SYSTEM READY ]</div>

            <!-- Manual mode -->
            <div class="section-label" id="manual-label">MANUAL MODE</div>

            <div class="form-group">
                <label for="length" id="length-label">Password Length:</label>
                <input type="number" id="length" min="8" max="128" value="16">
            </div>

            <div class="form-group">
                <label id="include-label">Include:</label>
                <div class="checkbox-group">
                    <div class="checkbox-item">
                        <input type="checkbox" id="uppercase" checked>
                        <label for="uppercase" id="uppercase-label">Uppercase Letters (A-Z)</label>
                    </div>
                    <div class="checkbox-item">
                        <input type="checkbox" id="lowercase" checked>
                        <label for="lowercase" id="lowercase-label">Lowercase Letters (a-z)</label>
                    </div>
                    <div class="checkbox-item">
                        <input type="checkbox" id="numbers" checked>
                        <label for="numbers" id="numbers-label">Numbers (0-9)</label>
                    </div>
                    <div class="checkbox-item">
                        <input type="checkbox" id="symbols" checked>
                        <label for="symbols" id="symbols-label">Special Characters (!@#$%^&*)</label>
                    </div>
                </div>
            </div>

            <button id="generate-btn">Generate Password</button>

            <div class="password-container">
                <div class="password-display" id="password-display">waiting for input...</div>
                <button class="copy-btn" id="copy-btn">Copy</button>
            </div>

            <div class="strength-meter">
                <div class="strength-fill" id="strength-fill"></div>
            </div>
            <div class="strength-text" id="strength-text"></div>

            <!-- AI mode -->
            <div class="section-label" id="ai-label">AI MODE</div>

            <div class="form-group">
                <label for="ai-input" id="ai-input-label">Describe what you need:</label>
                <textarea id="ai-input" placeholder="e.g. a password for my bank account that I can remember"></textarea>
            </div>

            <button class="ai-btn" id="ai-btn">Generate with AI</button>

            <div class="ai-loading" id="ai-loading">[ PROCESSING... ]</div>

            <div class="ai-result" id="ai-result">
                <div class="ai-password-line" id="ai-password"></div>
                <div class="ai-explanation" id="ai-explanation"></div>
            </div>

            <div class="footer">
                <div class="footer-name">Joël Moyal</div>
                <div class="social-links">
                    <a href="https://nl.linkedin.com/in/joel-moyal" target="_blank" class="social-link">
                        <svg class="social-icon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                            <path d="M16 8a6 6 0 0 1 6 6v7h-4v-7a2 2 0 0 0-2-2 2 2 0 0 0-2 2v7h-4v-7a6 6 0 0 1 6-6z"></path>
                            <rect x="2" y="9" width="4" height="12"></rect>
                            <circle cx="4" cy="4" r="2"></circle>
                        </svg>
                        LinkedIn
                    </a>
                    <a href="https://github.com/joelmoyal" target="_blank" class="social-link">
                        <svg class="social-icon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                            <path d="M9 19c-5 1.5-5-2.5-7-3m14 6v-3.87a3.37 3.37 0 0 0-.94-2.61c3.14-.35 6.44-1.54 6.44-7A5.44 5.44 0 0 0 20 4.77 5.07 5.07 0 0 0 19.91 1S18.73.65 16 2.48a13.38 13.38 0 0 0-7 0C6.27.65 5.09 1 5.09 1A5.07 5.07 0 0 0 5 4.77a5.44 5.44 0 0 0-1.5 3.78c0 5.42 3.3 6.61 6.44 7A3.37 3.37 0 0 0 9 18.13V22"></path>
                        </svg>
                        GitHub
                    </a>
                    <a href="https://joelmoyal.com" target="_blank" class="social-link">
                        <svg class="social-icon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                            <circle cx="12" cy="12" r="10"></circle>
                            <line x1="2" y1="12" x2="22" y2="12"></line>
                            <path d="M12 2a15.3 15.3 0 0 1 4 10 15.3 15.3 0 0 1-4 10 15.3 15.3 0 0 1-4-10 15.3 15.3 0 0 1 4-10z"></path>
                        </svg>
                        Portfolio
                    </a>
                </div>
            </div>
        </div>
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', function () {
            const lengthInput = document.getElementById('length');
            const uppercaseCheckbox = document.getElementById('uppercase');
            const lowercaseCheckbox = document.getElementById('lowercase');
            const numbersCheckbox = document.getElementById('numbers');
            const symbolsCheckbox = document.getElementById('symbols');
            const generateBtn = document.getElementById('generate-btn');
            const passwordDisplay = document.getElementById('password-display');
            const copyBtn = document.getElementById('copy-btn');
            const strengthFill = document.getElementById('strength-fill');
            const strengthText = document.getElementById('strength-text');
            const langEn = document.getElementById('lang-en');
            const langDe = document.getElementById('lang-de');
            const aiBtn = document.getElementById('ai-btn');
            const aiInput = document.getElementById('ai-input');
            const aiResult = document.getElementById('ai-result');
            const aiPassword = document.getElementById('ai-password');
            const aiExplanation = document.getElementById('ai-explanation');
            const aiLoading = document.getElementById('ai-loading');

            let currentLang = 'en';

            const uppercase = 'ABCDEFGHIJKLMNOPQRSTUVWXYZ';
            const lowercase = 'abcdefghijklmnopqrstuvwxyz';
            const numbers = '0123456789';
            const symbols = '!@#$%^&*()_+-=[]{}|;:,.<>?';

            generateBtn.addEventListener('click', generatePassword);
            generatePassword();

            // Typewriter effect
            function typewriterEffect(element, text, speed = 30) {
                element.textContent = '';
                let i = 0;
                const timer = setInterval(() => {
                    if (i < text.length) {
                        element.textContent += text[i];
                        i++;
                    } else {
                        clearInterval(timer);
                    }
                }, speed);
            }

            function generatePassword() {
                let length = parseInt(lengthInput.value);
                if (isNaN(length) || length < 8) { length = 8; lengthInput.value = 8; }
                else if (length > 128) { length = 128; lengthInput.value = 128; }

                if (!uppercaseCheckbox.checked && !lowercaseCheckbox.checked &&
                    !numbersCheckbox.checked && !symbolsCheckbox.checked) {
                    lowercaseCheckbox.checked = true;
                }

                let chars = '';
                if (uppercaseCheckbox.checked) chars += uppercase;
                if (lowercaseCheckbox.checked) chars += lowercase;
                if (numbersCheckbox.checked) chars += numbers;
                if (symbolsCheckbox.checked) chars += symbols;

                let password = '';
                if (uppercaseCheckbox.checked) password += uppercase.charAt(Math.floor(Math.random() * uppercase.length));
                if (lowercaseCheckbox.checked) password += lowercase.charAt(Math.floor(Math.random() * lowercase.length));
                if (numbersCheckbox.checked) password += numbers.charAt(Math.floor(Math.random() * numbers.length));
                if (symbolsCheckbox.checked) password += symbols.charAt(Math.floor(Math.random() * symbols.length));

                for (let i = password.length; i < length; i++) {
                    password += chars.charAt(Math.floor(Math.random() * chars.length));
                }

                password = shuffleString(password);
                typewriterEffect(passwordDisplay, password, 20);
                updateStrengthMeter(password);
            }

            function shuffleString(string) {
                let array = string.split('');
                for (let i = array.length - 1; i > 0; i--) {
                    const j = Math.floor(Math.random() * (i + 1));
                    [array[i], array[j]] = [array[j], array[i]];
                }
                return array.join('');
            }

            copyBtn.addEventListener('click', function () {
                const password = passwordDisplay.textContent;
                navigator.clipboard.writeText(password).then(function () {
                    const orig = copyBtn.textContent;
                    copyBtn.textContent = 'OK!';
                    setTimeout(() => { copyBtn.textContent = orig; }, 2000);
                }).catch(function () {
                    const textarea = document.createElement('textarea');
                    textarea.value = password;
                    document.body.appendChild(textarea);
                    textarea.select();
                    document.execCommand('copy');
                    document.body.removeChild(textarea);
                    const orig = copyBtn.textContent;
                    copyBtn.textContent = 'OK!';
                    setTimeout(() => { copyBtn.textContent = orig; }, 2000);
                });
            });

            function updateStrengthMeter(password) {
                let strength = 0;
                const lengthFactor = Math.min(1, password.length / 20);
                strength += lengthFactor * 40;

                const hasUpper = /[A-Z]/.test(password);
                const hasLower = /[a-z]/.test(password);
                const hasNumber = /\d/.test(password);
                const hasSymbol = /[^A-Za-z0-9]/.test(password);
                const varietyCount = [hasUpper, hasLower, hasNumber, hasSymbol].filter(Boolean).length;
                strength += varietyCount * 15;

                let color, label;
                if (strength < 40) {
                    color = '#ff3860';
                    label = currentLang === 'en' ? 'WEAK' : 'SCHWACH';
                } else if (strength < 70) {
                    color = '#ffdd57';
                    label = currentLang === 'en' ? 'MODERATE' : 'MITTEL';
                } else if (strength < 90) {
                    color = '#00cfff';
                    label = currentLang === 'en' ? 'STRONG' : 'STARK';
                } else {
                    color = '#00ff41';
                    label = currentLang === 'en' ? 'VERY STRONG' : 'SEHR STARK';
                }

                strengthFill.style.width = strength + '%';
                strengthFill.style.backgroundColor = color;
                strengthFill.style.boxShadow = `0 0 8px ${color}`;
                strengthText.textContent = label;
                strengthText.style.color = color;
            }

            // AI generation
            aiBtn.addEventListener('click', async function () {
                const description = aiInput.value.trim();
                if (!description) {
                    aiInput.focus();
                    return;
                }

                aiLoading.classList.add('visible');
                aiResult.classList.remove('visible');
                aiBtn.disabled = true;

                try {
                    const response = await fetch('/api/generate', {
                        method: 'POST',
                        headers: { 'Content-Type': 'application/json' },
                        body: JSON.stringify({ description })
                    });

                    if (!response.ok) throw new Error('API error');

                    const data = await response.json();
                    aiPassword.textContent = '> ' + (data.password || '');
                    aiExplanation.textContent = data.explanation || '';
                    aiResult.classList.add('visible');
                } catch (err) {
                    aiPassword.textContent = '';
                    aiExplanation.textContent = currentLang === 'en'
                        ? '[ERROR] Could not reach AI. Make sure the Workers AI binding is enabled in Cloudflare Pages settings.'
                        : '[FEHLER] KI nicht erreichbar. Bitte Workers AI-Bindung in Cloudflare Pages aktivieren.';
                    aiResult.classList.add('visible');
                } finally {
                    aiLoading.classList.remove('visible');
                    aiBtn.disabled = false;
                }
            });

            // Language
            const translations = {
                en: {
                    title: 'Secure Password Generator',
                    subtitle: '[ SYSTEM READY ]',
                    manualLabel: 'MANUAL MODE',
                    aiLabel: 'AI MODE',
                    lengthLabel: 'Password Length:',
                    includeLabel: 'Include:',
                    uppercaseLabel: 'Uppercase Letters (A-Z)',
                    lowercaseLabel: 'Lowercase Letters (a-z)',
                    numbersLabel: 'Numbers (0-9)',
                    symbolsLabel: 'Special Characters (!@#$%^&*)',
                    generateBtn: 'Generate Password',
                    copyBtn: 'Copy',
                    aiInputLabel: 'Describe what you need:',
                    aiPlaceholder: 'e.g. a password for my bank account that I can remember',
                    aiBtn: 'Generate with AI',
                    aiLoading: '[ PROCESSING... ]'
                },
                de: {
                    title: 'Sicherer Passwort-Generator',
                    subtitle: '[ SYSTEM BEREIT ]',
                    manualLabel: 'MANUELLER MODUS',
                    aiLabel: 'KI-MODUS',
                    lengthLabel: 'Passwortlänge:',
                    includeLabel: 'Einschließen:',
                    uppercaseLabel: 'Großbuchstaben (A-Z)',
                    lowercaseLabel: 'Kleinbuchstaben (a-z)',
                    numbersLabel: 'Zahlen (0-9)',
                    symbolsLabel: 'Sonderzeichen (!@#$%^&*)',
                    generateBtn: 'Passwort generieren',
                    copyBtn: 'Kopieren',
                    aiInputLabel: 'Beschreibe, was du brauchst:',
                    aiPlaceholder: 'z.B. ein Passwort für mein Bankkonto, das ich mir merken kann',
                    aiBtn: 'Mit KI generieren',
                    aiLoading: '[ VERARBEITUNG... ]'
                }
            };

            function setLanguage(lang) {
                currentLang = lang;
                const t = translations[lang];
                document.getElementById('title').childNodes[0].textContent = t.title;
                document.getElementById('subtitle').textContent = t.subtitle;
                document.getElementById('manual-label').childNodes[0] && (document.getElementById('manual-label').textContent = t.manualLabel);
                document.getElementById('ai-label').textContent = t.aiLabel;
                document.getElementById('length-label').textContent = t.lengthLabel;
                document.getElementById('include-label').textContent = t.includeLabel;
                document.getElementById('uppercase-label').textContent = t.uppercaseLabel;
                document.getElementById('lowercase-label').textContent = t.lowercaseLabel;
                document.getElementById('numbers-label').textContent = t.numbersLabel;
                document.getElementById('symbols-label').textContent = t.symbolsLabel;
                document.getElementById('generate-btn').textContent = t.generateBtn;
                document.getElementById('copy-btn').textContent = t.copyBtn;
                document.getElementById('ai-input-label').textContent = t.aiInputLabel;
                document.getElementById('ai-input').placeholder = t.aiPlaceholder;
                document.getElementById('ai-btn').textContent = t.aiBtn;
                document.getElementById('ai-loading').textContent = t.aiLoading;

                if (lang === 'en') {
                    langEn.classList.add('active');
                    langDe.classList.remove('active');
                } else {
                    langEn.classList.remove('active');
                    langDe.classList.add('active');
                }

                if (strengthText.textContent) updateStrengthMeter(passwordDisplay.textContent);
            }

            langEn.addEventListener('click', () => setLanguage('en'));
            langDe.addEventListener('click', () => setLanguage('de'));
            setLanguage('en');
        });
    </script>
</body>
</html>
